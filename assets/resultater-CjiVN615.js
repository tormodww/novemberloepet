import{r as j,j as e,a as R,T as A}from"./Toolbar-B0NiT4Bs.js";import{p as v}from"./participants-hiEC40SX.js";import{s as y,g as T,a as $}from"./storageApi-BNNNQTAE.js";function F(){try{const n=T(),u=$();return{times:n,status:u}}catch{return{times:{},status:{}}}}function k(){const[n,u]=j.useState(F()),[r,w]=j.useState("ALL");function E(){u(F())}const x=r==="ALL"?null:n.times[r]||{},p=r==="ALL"?null:n.status[r]||{};return e.jsxs("div",{className:"w-full max-w-md mx-auto text-center px-2 py-8",children:[e.jsx("h1",{className:"text-2xl font-bold mb-8",children:"Resultater"}),e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{htmlFor:"stage-result-select",className:"block mb-2 font-semibold",children:"Velg etappe:"}),e.jsxs("select",{id:"stage-result-select",value:r,onChange:s=>w(s.target.value),className:"w-full border rounded-md px-3 py-3 text-lg",children:[e.jsx("option",{value:"ALL",children:"Samlet resultat"}),y.map(s=>e.jsx("option",{value:s,children:s},s))]})]}),e.jsx("button",{className:"mb-6 px-4 py-2 bg-blue-100 rounded text-blue-700",onClick:E,children:"Oppdater"}),e.jsx("ul",{className:"mb-8",children:r==="ALL"?(()=>{function s(t){if(!t)return null;const[a,m]=t.split(":").map(Number);return a*60+m}const i=v.map(t=>{let a=0,m=0,D=!1;const g=[];return y.forEach(N=>{var S,L;const l=(S=n.times[N])==null?void 0:S[t.id],h=(L=n.status[N])==null?void 0:L[t.id];if(h==="DNS"||h==="DNF")D=!0,g.push(`${N} (${h})`);else if(l!=null&&l.start&&(l!=null&&l.end)){const f=s(l.start),b=s(l.end);f!==null&&b!==null&&b>f&&(a+=b-f,m++)}}),{id:t.id,name:t.name,total:a,validEtapper:m,hasDNSorDNF:D,dnsDnfStages:g}}),c=i.filter(t=>t.validEtapper>0&&!t.hasDNSorDNF),o=i.filter(t=>t.hasDNSorDNF),d=i.filter(t=>t.validEtapper===0&&!t.hasDNSorDNF);return c.sort((t,a)=>t.total-a.total),[...c,...o,...d].map((t,a)=>e.jsxs("li",{className:"py-2 border-b last:border-b-0 flex flex-col sm:flex-row items-start sm:items-center justify-between",children:[e.jsxs("span",{className:t.hasDNSorDNF?"text-red-600":"",children:[a+1,". ",t.name]}),e.jsx("span",{className:t.hasDNSorDNF?"text-red-600 text-sm":"text-gray-600 text-sm",children:t.hasDNSorDNF?e.jsx("span",{className:"block text-xs text-red-700",children:t.dnsDnfStages.join(", ")}):t.validEtapper>0?`${t.total} min (${t.validEtapper} etapper)`:"Ingen registrering"})]},t.id))})():v.map(s=>{const i=p==null?void 0:p[s.id],c=x==null?void 0:x[s.id],o=i==="DNS",d=i==="DNF";return e.jsxs("li",{className:"py-2 border-b last:border-b-0 flex items-center justify-between",children:[e.jsx("span",{className:o||d?"text-red-600":"",children:s.name}),e.jsx("span",{className:o||d?"text-red-600 text-sm":"text-gray-600 text-sm",children:o?"DNS":d?"DNF":c?`Start: ${c.start||"-"} / Slutt: ${c.end||"-"}`:"Ingen registrering"})]},s.id)})}),e.jsx("a",{className:"block mt-6 text-blue-600 underline w-full sm:w-auto text-base sm:text-lg",href:"admin.html",children:"Tilbake til admin"})]})}R(document.getElementById("root")).render(e.jsx(j.StrictMode,{children:e.jsxs(e.Fragment,{children:[e.jsx(A,{}),e.jsx("div",{className:"pt-20",children:e.jsx(k,{})})]})}));
