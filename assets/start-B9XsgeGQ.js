import{a as P,j as e,r as o,T as M}from"./Toolbar-B0NiT4Bs.js";import{s as K}from"./stages-C8iUDG9v.js";import{p as I}from"./participants-hiEC40SX.js";function J({stage:x,selected:D,onSelect:b}){var w;const F=JSON.parse(localStorage.getItem("participantTimes")||"{}"),k=JSON.parse(localStorage.getItem("participantStatus")||"{}"),j=F[x]||{},N=k[x]||{},[O,t]=o.useState(!1),l=I.find(r=>r.id===D);let g="",m="px-4 py-2 rounded cursor-pointer border-2 border-blue-500 bg-white",h={};return l&&(N[l.id]==="DNS"?(g=" (DNS)",m="px-4 py-2 rounded cursor-pointer border-2 border-red-600 font-bold",h={backgroundColor:"#dc2626",color:"#fff",fontWeight:"bold"}):N[l.id]==="DNF"?(g=" (DNF)",m="px-4 py-2 rounded cursor-pointer border-2 border-red-600 font-bold",h={backgroundColor:"#dc2626",color:"#fff",fontWeight:"bold"}):(w=j[l.id])!=null&&w.start?g=` ${j[l.id].start}`:g=""),e.jsxs("div",{children:[e.jsxs("h2",{className:"text-xl font-bold text-blue-700 bg-blue-100 rounded px-4 py-2 mb-4",children:["Etappe: ",x]}),e.jsx("p",{className:"mb-2",children:"Velg deltaker"}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:m+" w-full",onClick:()=>t(r=>!r),role:"button",tabIndex:0,style:{outline:"none",...h},onKeyDown:r=>{(r.key==="Enter"||r.key===" ")&&t(d=>!d)},children:l?`#${l.id} - ${l.name}${g}`:"Startnummer eller navn"}),O&&e.jsx("div",{className:"absolute z-50 w-full border-2 border-blue-500 rounded-md bg-blue-50 shadow-2xl mt-2 max-h-96 overflow-y-auto",children:I.map((r,d)=>{var f;let c="",u="cursor-pointer px-4 py-2 hover:bg-blue-100 transition";return u+=d%2===0?" bg-blue-50":" bg-blue-100",N[r.id]==="DNS"?(c=" (DNS)",u+=" bg-red-600 text-white font-bold"):N[r.id]==="DNF"?(c=" (DNF)",u+=" bg-red-600 text-white font-bold"):(f=j[r.id])!=null&&f.start?c=` ${j[r.id].start}`:c="",D===r.id&&(u+=" ring-2 ring-blue-600"),e.jsxs("div",{className:u,onClick:()=>{b(r.id),t(!1)},role:"button",tabIndex:0,style:{outline:"none"},onKeyDown:s=>{(s.key==="Enter"||s.key===" ")&&(b(r.id),t(!1))},children:["#",r.id," - ",r.name,c]},r.id)})})]})]})}function V(){const[x,D]=o.useState(""),[b,F]=o.useState(""),[k,j]=o.useState(!1);return e.jsxs(e.Fragment,{children:[e.jsx(M,{}),e.jsxs("div",{className:"min-h-screen flex flex-col items-center justify-center p-4 pt-20",children:[e.jsx("h1",{className:"text-2xl font-bold mb-6",children:"Registrer Starttid"}),x?b?e.jsx("div",{className:"w-full max-w-md mx-auto",children:e.jsx(O,{stage:x,participant:b,type:"start"})}):e.jsx("div",{className:"w-full max-w-md mx-auto",children:e.jsx(J,{stage:x,selected:b,onSelect:F})}):e.jsx("div",{className:"w-full max-w-md mx-auto",children:e.jsx(N,{onSelect:D})})]})]});function N({onSelect:t}){return e.jsxs(e.Fragment,{children:[e.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Velg etappe"}),e.jsx("div",{className:"flex flex-col gap-3",children:K.map(l=>e.jsx("button",{onClick:()=>t(l),className:"bg-gray-200 hover:bg-blue-600 hover:text-white py-3 rounded-md font-medium",children:l},l))})]})}function O({stage:t,participant:l,type:g}){const[m,h]=o.useState(""),[w,r]=o.useState(!1),[d,c]=o.useState(""),[u,f]=o.useState(void 0),[s,C]=o.useState(l),[W,L]=o.useState({}),y=o.useCallback(()=>{const i=JSON.parse(localStorage.getItem("participantTimes")||"{}"),a=JSON.parse(localStorage.getItem("participantStatus")||"{}"),n=i[t]||{},v=a[t]||{},S={};I.forEach(p=>{var T;v[p.id]==="DNS"?S[p.id]="DNS":v[p.id]==="DNF"?S[p.id]="DNF":(T=n[p.id])!=null&&T.start?S[p.id]=n[p.id].start:S[p.id]=""}),L(S)},[t]);o.useEffect(()=>{var S;const i=JSON.parse(localStorage.getItem("participantTimes")||"{}"),a=JSON.parse(localStorage.getItem("participantStatus")||"{}"),n=i[t]||{},v=a[t]||{};c(((S=n[s])==null?void 0:S.start)||""),f(v[s]||void 0),r(!1),h(""),y()},[s,t,y]);const R=()=>{let i="";m?i=m:i=new Date().toLocaleTimeString("no-NO",{hour:"2-digit",minute:"2-digit"}),c(i),r(!0),f(void 0);const a=JSON.parse(localStorage.getItem("participantTimes")||"{}");a[t]||(a[t]={}),a[t][s]||(a[t][s]={}),a[t][s].start=i,localStorage.setItem("participantTimes",JSON.stringify(a));const n=JSON.parse(localStorage.getItem("participantStatus")||"{}");n[t]&&n[t][s]&&(delete n[t][s],Object.keys(n[t]).length===0&&delete n[t],localStorage.setItem("participantStatus",JSON.stringify(n))),y()},E=()=>{f("DNS"),c("DNS"),r(!0);const i=JSON.parse(localStorage.getItem("participantStatus")||"{}");i[t]||(i[t]={}),i[t][s]="DNS",localStorage.setItem("participantStatus",JSON.stringify(i));const a=JSON.parse(localStorage.getItem("participantTimes")||"{}");a[t]&&a[t][s]&&(delete a[t][s].start,Object.keys(a[t][s]).length===0&&delete a[t][s],localStorage.setItem("participantTimes",JSON.stringify(a))),y()},$=()=>{f("DNF"),c("DNF"),r(!0);const i=JSON.parse(localStorage.getItem("participantStatus")||"{}");i[t]||(i[t]={}),i[t][s]="DNF",localStorage.setItem("participantStatus",JSON.stringify(i));const a=JSON.parse(localStorage.getItem("participantTimes")||"{}");a[t]&&a[t][s]&&(delete a[t][s].start,Object.keys(a[t][s]).length===0&&delete a[t][s],localStorage.setItem("participantTimes",JSON.stringify(a))),y()};return e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"mb-4",children:e.jsx(J,{stage:t,selected:s,onSelect:C})}),e.jsxs("p",{className:"mb-4 text-base sm:text-lg",children:["Deltaker #",s," på etappe ",t]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{htmlFor:"manual-time",className:"block mb-1",children:"Manuell tid (hh:mm):"}),e.jsx("input",{id:"manual-time",type:"time",value:m,onChange:i=>h(i.target.value),className:"border px-3 py-3 rounded w-full text-base sm:text-lg"})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row flex-wrap gap-2 justify-center mb-4",children:[e.jsx("button",{onClick:R,className:"bg-green-600 text-white px-6 py-4 rounded-md w-full sm:w-auto text-base sm:text-lg",disabled:!s,children:m?"Registrer manuell tid":"Registrer tid nå"}),e.jsx("button",{onClick:E,className:"bg-yellow-500 text-white px-6 py-4 rounded-md w-full sm:w-auto text-base sm:text-lg",type:"button",disabled:!s,children:"DNS"}),e.jsx("button",{onClick:$,className:"bg-red-600 text-white px-6 py-4 rounded-md w-full sm:w-auto text-base sm:text-lg",type:"button",disabled:!s,children:"DNF"})]}),w&&e.jsxs("div",{className:"p-4 bg-green-100 border border-green-400 rounded-md mt-4",children:[d==="DNS"&&e.jsxs(e.Fragment,{children:["DNS registrert for #",s]}),d==="DNF"&&e.jsxs(e.Fragment,{children:["DNF registrert for #",s]}),d!=="DNS"&&d!=="DNF"&&e.jsxs(e.Fragment,{children:["Tid registrert for #",s," kl. ",d]})]}),u&&e.jsxs("div",{className:"mt-2 text-red-600 font-bold",children:["Status: ",u]})]})}}P(document.getElementById("root")).render(e.jsx(o.StrictMode,{children:e.jsx(V,{})}));
